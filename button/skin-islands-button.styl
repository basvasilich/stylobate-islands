// What to simplify:
// 1. Detail/skin/kind for layered button with gradiented borders, to call both gradients at the same time.
// 2. Move different buttons to other files.
// 3. Move the focus to skin/detail, to use it both there and for pseudo-button
// 4. Better handling of arguments?

// Proto for simple buttons
$skin-islands-button-content ?= '.button-content'
$skin-islands-button-disabled ?= '.is-disabled'

skin-islands-proto-button()
  @extends $skin-islands-proto-button

  if one-element in arguments and !ie
    @extends $skin-islands-proto-button_one-element

  if fly in arguments
    @extends $skin-islands-proto-button_fly

  if small in arguments
    @extends $skin-islands-proto-button_small

  else if adaptive in arguments
    @extends $skin-islands-proto-button_adaptive

  else if not sizeless in arguments
    @extends $skin-islands-proto-button_medium

  &:not({$skin-islands-button-disabled}):active
    skin-islands-button_pressed(arguments)

    dope()
      // See https://github.com/LearnBoost/stylus/issues/1104
    &
      dope()

// Common styles for all buttons
$skin-islands-proto-button
  skin-islands-check-font()

  // unless only in arguments
  position: relative

  vertical-align: baseline
  user-select: none

  color: $islands_color_text

  border-radius: 3px

  box-shadow: 0 1px 0 rgba(#000, 0.07)

  &:before
    content: ""
    kind: fill 1px
    border-radius: 2px

  // So it would overlay anything inside
  &:after
    content: ""
    kind: fill

  &:not({$skin-islands-button-disabled}):focus
    skin-islands-button_focus()

  & > {$skin-islands-button-content}
    kind: block
    if ie
      button&
        margin: -1px -1px -3px

// One-element
$skin-islands-proto-button_one-element
  color: transparent
  color: $islands_color_text unquote('\0/') // For IE9

  text-shadow: 0 0 0 $islands_color_text
  z-index: 9

  &:before
    z-index: -1

// Flying
$skin-islands-proto-button_fly
  box-shadow: 0 8px 20px -5px rgba(#000, 0.25)

// Default medium size
$skin-islands-proto-button_medium
  skin-islands-para(no-margin)
  if !ie
    padding: ($islands_xs - 0.1*rem) ($islands_m - 0.1*rem)
  else
    padding: ($islands_xs - 0.2*rem) ($islands_m - 0.2*rem)

// Small size button
$skin-islands-proto-button_small
  skin-islands-para2(no-margin)
  if !ie
    padding: ($islands_xs - 0.1*rem) ($islands_m - 0.3*rem)
  else
    padding: ($islands_xs - 0.2*rem) ($islands_m - 0.4*rem)

// Adaptive size button
$skin-islands-proto-button_adaptive
  width: 1em
  height: 1em
  padding: 0 1px 1px 0
  line-height: 1em


// Normal button
skin-islands-button()
  skin-islands-proto-button(arguments)

  @extends $skin-islands-button

$skin-islands-button
  if !ie
    gradient: #000 0.2, 0.4

    &:before
      gradient: #FFF, #EEE

  else
    background: #F6F6F6
    border: 1px solid
    border-color: #CBCBCB #B2B2B2 #9A9A9A

  &:not({$skin-islands-button-disabled}):hover
    skin-islands-button_hover()

// Action button
skin-islands-action-button()
  skin-islands-proto-button(arguments)

  @extends $skin-islands-action-button

$skin-islands-action-button
  if !ie
    gradient: #604000 0.4, #462f00 0.54

    &:before
      gradient: #FFDF60, #FFCC00

  else
    background: #FFD52E
    border: 1px solid
    border-color: #BFB298 #A99C82 #9B8E75

  &:not({$skin-islands-button-disabled}):hover
    skin-islands-action-button_hover()

// Hover state
skin-islands-button_hover()
  @extends $skin-islands-button_hover

$skin-islands-button_hover
  gradient: #000 0.22, 0.4

  &:before
    gradient: #FFF, #F6F5F3


// Hover state for action
skin-islands-action-button_hover()
  @extends $skin-islands-action-button_hover

$skin-islands-action-button_hover
  gradient: #000 0.22, 0.4

  &:before
    gradient: #FFE681, #FFD428

// Pressed state
skin-islands-button_pressed()
  unless no-active in arguments
    if !ie
      if fly in arguments
        @extends $skin-islands-button_fly_pressed
      else
        @extends $skin-islands-button_pressed

        if one-element in arguments
          text-shadow: 0 1px 0 $islands_color_text
        else
          @extends $skin-islands-button_pressed-content

$skin-islands-button_pressed
  box-shadow: inset 0 2px 1px -1px rgba(#000, 0.4), 0 1px 0 rgba(#FFF, 0.2)

  &:before
    box-shadow: inset 0 1px 3px -1px rgba(#000, 0.5)

  &-content
    & > {$skin-islands-button-content}
      top: 1px

$skin-islands-button_fly_pressed
  top: 1px
  box-shadow: 0 4px 10px -4px rgba(#000, 0.45)
